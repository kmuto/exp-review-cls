\documentclass[book,twoside,
  paper=b5,
  fontsize=12Q, jafontsize=12Q, baselineskip=21.6Q
]{jlreq}

\usepackage{<%= @texcompiler%>-packages}
\usepackage{<%= @texcompiler%>-fonts}

% styになるとerbで渡せない。layout.tex.erbでkeyvalに入れておいて、styに渡す、とか?
\newcommand{\reviewimageref}[2]{<%= escape_latex(I18n.t("image"))%> #1}
\newcommand{\reviewtableref}[2]{<%= escape_latex(I18n.t("table"))%> #1}
\newcommand{\reviewlistref}[1]{<%= escape_latex(I18n.t("list"))%> #1}
\newcommand{\reviewbibref}[2]{#1}
\newcommand{\reviewcolumnref}[2]{<%= escape_latex(I18n.t("columnname"))%> #1}
\newcommand{\reviewsecref}[2]{#1}

\makeatletter
% 以下はよくわかっていない…(munepiさんコード)
\def\maxwidth{%
  \ifdim\Gin@nat@width>\linewidth
    % \linewidth
    \dimexpr\linewidth - 1\p@ - 3mm\relax
  \else
    % \Gin@nat@width
    \dimexpr\Gin@nat@width - 1\p@ - 3mm\relax
  \fi
}
\makeatother% @を戻す

\usepackage{box-tcolorbox}
\usepackage{common-define}
\usepackage{jlreq-layout}

% 以下ドキュメントコンテンツ
\begin{document}
\frontmatter
<%= @input_files["PREDEF"] %>

<%- if @config["toc"] -%>
\setcounter{tocdepth}{<%= @config["toclevel"] - 1 %>}
\tableofcontents
<%- end -%>

\mainmatter
<%= @input_files["CHAPS"] %>

\reviewappendix
<%= @input_files["APPENDIX"] %>

<%- if @input_files["POSTDEF"] or @config["colophon"] -%>
\backmatter
<%- end -%>

<%- if @input_files["POSTDEF"] -%>
<%= @input_files["POSTDEF"] %>
<%- end -%>
\end{document}
